(function(e){function t(t){for(var r,o,i=t[0],c=t[1],u=t[2],p=0,d=[];p<i.length;p++)o=i[p],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(d.length)d.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(r=!1)}r&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},s=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("85ec"),a=n.n(r);a.a},"3e03":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("b-container",{staticClass:"h-100 d-flex flex-column px-0",attrs:{fluid:""}},[n("Header"),n("router-view")],1)],1)},s=[],o=n("8c4f"),i=(n("99af"),n("4160"),n("b64b"),n("d3b7"),n("159b"),n("96cf"),n("1da1")),c=n("d4ec"),u=n("bee2"),l=n("ade3"),p=function(){function e(){if(Object(c["a"])(this,e),Object(l["a"])(this,"modelBaseUrl",void 0),Object(l["a"])(this,"modelRequest",void 0),this._buildUrl=this._buildUrl.bind(this),this._buildUrlWithParams=this._buildUrlWithParams.bind(this),void 0===this.getModelRequest)throw new TypeError("getModelRequest must be implemented in the derived class");this.modelRequest=this.getModelRequest(),this.modelBaseUrl=this._buildUrl()}return Object(u["a"])(e,[{key:"_buildUrl",value:function(){return"/api".concat(this.modelRequest)}},{key:"_buildUrlWithParams",value:function(e,t){var n=this.modelBaseUrl+(t?"/":"");return e&&(n+="?",Object.keys(e).forEach((function(t){n+="".concat(t,"=").concat(e[t],"&")}))),n}},{key:"doRequest",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n,r,a){var s,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=this._buildUrlWithParams(a,"POST"===n),t.next=3,fetch(s,{method:n||"GET",body:r?JSON.stringify(r):void 0,headers:{"Content-Type":"application/json",Authorization:e.authToken?"Token ".concat(e.authToken):void 0}});case 3:if(o=t.sent,!o.ok){t.next=16;break}if(204===o.status){t.next=11;break}return t.next=8,o.json();case 8:t.t0=t.sent,t.next=12;break;case 11:t.t0={status:"deleted"};case 12:return i=t.t0,t.abrupt("return",i);case 16:throw o;case 17:case"end":return t.stop()}}),t,this)})));function n(e,n,r){return t.apply(this,arguments)}return n}()},{key:"get",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.doRequest("GET",null,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"post",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.doRequest("POST",t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"put",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.doRequest("PUT",t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"delete",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doRequest("DELETE",t,n));case 1:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getModelRequest",value:function(){throw new Error("This method must be implemented!")}}],[{key:"setAuthToken",value:function(t){e.authToken=t.token,e.currentUserId=t.user._id,localStorage.setItem("authToken",e.authToken),localStorage.setItem("currentUserId",e.currentUserId)}},{key:"clearAuthToken",value:function(){delete e.authToken,delete e.currentUserId,localStorage.removeItem("authToken"),localStorage.removeItem("currentUserId")}},{key:"loadAuthToken",value:function(){e.authToken=localStorage.getItem("authToken"),e.currentUserId=localStorage.getItem("currentUserId")}}]),e}();Object(l["a"])(p,"authToken",void 0),Object(l["a"])(p,"currentUserId",void 0),p.loadAuthToken();var d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"w-25 my-auto mx-auto"},[n("label",[e._v(" E-mail: ")]),n("b-input",{staticClass:"mb-2",attrs:{type:"email",placeholder:"Электронная почта"},model:{value:e.loginEmail,callback:function(t){e.loginEmail=t},expression:"loginEmail"}}),n("label",[e._v(" Пароль: ")]),n("b-input",{staticClass:"mb-2",attrs:{type:"password",placeholder:"Пароль"},model:{value:e.loginPassword,callback:function(t){e.loginPassword=t},expression:"loginPassword"}}),n("div",{staticClass:"d-flex"},[n("b-button",{attrs:{variant:"primary"},on:{click:e.login}},[e._v(" Log In ")]),n("a",{staticClass:"ml-2",attrs:{href:"/signup"}},[e._v(" Sign Up ")])],1)],1)},m=[],f=(n("b0c0"),n("257e")),h=n("262e"),v=n("2caf"),b=function(e){Object(h["a"])(n,e);var t=Object(v["a"])(n);function n(e){var r;return Object(c["a"])(this,n),r=t.call(this),r.id=e,r.getAllUsers=r.getAllUsers.bind(Object(f["a"])(r)),r.getUserById=r.getUserById.bind(Object(f["a"])(r)),r.signupUser=r.signupUser.bind(Object(f["a"])(r)),r.loginUser=r.loginUser.bind(Object(f["a"])(r)),r.modelRequest=r.getModelRequest(),r.modelBaseUrl=r._buildUrl(),r}return Object(u["a"])(n,[{key:"getModelRequest",value:function(){var e="/users";return this.id&&(e="/users/".concat(this.id)),e}},{key:"getAllUsers",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.get();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getAllDoctors",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.modelBaseUrl,this.modelBaseUrl+="/doctors",e.next=4,this.get();case 4:return n=e.sent,this.modelBaseUrl=t,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getUserById",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.get();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"signupUser",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,n,r,a){var s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=this.modelBaseUrl,this.modelBaseUrl+="/signup",e.next=4,this.post({username:t,email:n,name:r,password:a});case 4:return o=e.sent,this.modelBaseUrl=s,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)})));function t(t,n,r,a){return e.apply(this,arguments)}return t}()},{key:"loginUser",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=this.modelBaseUrl,this.modelBaseUrl+="/login",e.next=4,this.post({email:t,password:n});case 4:return a=e.sent,this.modelBaseUrl=r,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()}]),n}(p),g={name:"LoginPage",data:function(){return{loginEmail:"",loginPassword:"",username:"",email:"",name:"",password:""}},methods:{login:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new b,t.prev=1,t.next=4,n.loginUser(e.loginEmail,e.loginPassword);case 4:r=t.sent,console.log(r),b.setAuthToken(r),e.$router.history.push("/appointments"),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})))()},signup:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a,s,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new b,t.prev=1,r=e.username,a=e.email,s=e.name,o=e.password,t.next=5,n.signupUser(r,a,s,o);case 5:i=t.sent,console.log(i),b.setAuthToken(i),e.$router.history.push("/appointments"),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](1),console.log(t.t0),event.preventDefault();case 15:case"end":return t.stop()}}),t,null,[[1,11]])})))()}}},w=g,y=n("2877"),k=Object(y["a"])(w,d,m,!1,null,"e776b596",null),x=k.exports,O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"w-25 my-auto mx-auto"},[n("label",[e._v(" Фамилия Имя Отчество: ")]),n("b-input",{staticClass:"mb-2",attrs:{type:"text",placeholder:"ФИО"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("label",[e._v(" Имя пользователя: ")]),n("b-input",{staticClass:"mb-2",attrs:{type:"text",placeholder:"Имя пользователя"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),n("label",[e._v(" E-mail: ")]),n("b-input",{staticClass:"mb-2",attrs:{type:"email",placeholder:"Электронная почта"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),n("label",[e._v(" Пароль: ")]),n("b-input",{staticClass:"mb-2",attrs:{type:"password",placeholder:"Пароль"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("div",{staticClass:"d-flex"},[n("b-button",{attrs:{variant:"primary"},on:{click:e.signup}},[e._v(" Sign Up ")])],1)],1)},_=[],D={name:"LoginPage",data:function(){return{username:"",email:"",name:"",password:""}},methods:{signup:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a,s,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new b,t.prev=1,r=e.username,a=e.email,s=e.name,o=e.password,t.next=5,n.signupUser(r,a,s,o);case 5:i=t.sent,console.log(i),b.setAuthToken(i),e.$router.history.push("/appointments"),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](1),console.log(t.t0),event.preventDefault();case 15:case"end":return t.stop()}}),t,null,[[1,11]])})))()}}},j=D,T=Object(y["a"])(j,O,_,!1,null,"4a5d7e88",null),R=T.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.user?n("div",{staticClass:"d-flex"},[n("Profile",{attrs:{user:e.user}}),n("OwnAppointments",{attrs:{refreshTrigger:e.refreshTrigger,isDoctor:!!e.user.doctor}})],1):e._e(),e.user?n("div",[e.user.doctor?e._e():n("CalendarAppointments",{on:{"refresh-own-appointments":e.refreshOwnAppointments}}),e.user.doctor?n("DoctorSchedule",{attrs:{doctorId:e.user.doctor._id,doctorProfile:e.user.doctor}}):e._e()],1):e._e()])},A=[],C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.user?n("div",{staticClass:"p-4"},[n("h3",[e._v(e._s(e.user.name))]),n("p",[n("strong",[e._v("Логин пользователя:")]),e._v(" "+e._s(e.user.username))]),n("p",[n("strong",[e._v("E-mail:")]),e._v(" "+e._s(e.user.email))]),n("p",[n("strong",[e._v("ИК Медицинской Карты:")]),e._v(" "+e._s(e.user._id))]),n("p",[n("strong",[e._v("Дата регистрации:")]),e._v(" "+e._s(e.user.createdAt))])]):e._e()},I=[],P={name:"Profile",props:{user:Object}},S=P,E=Object(y["a"])(S,C,I,!1,null,null,null),B=E.exports,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"p-4"},[n("table",{staticClass:"table own-appoints-max-height"},[n("thead",[n("tr",[n("th",[e._v(" # ")]),n("th",[e._v(" "+e._s(e.isDoctor?"Имя клиента":"Имя врача")+" ")]),n("th",[e._v(" "+e._s(e.isDoctor?"ИД клиента":"Специальность врача")+" ")]),n("th",[e._v(" Дата записи ")]),e.isDoctor?n("th",[e._v(" Удалить ")]):e._e()])]),n("tbody",e._l(e.appointments,(function(t,r){return n("tr",{key:t._id},[n("td",[e._v(" "+e._s(r+1)+" ")]),n("td",[e._v(" "+e._s(e.isDoctor?t.clientProfile.name:t.doctorUser.name)+" ")]),n("td",[e._v(" "+e._s(e.isDoctor?t.clientProfile._id:t.doctorProfile.speciality)+" ")]),n("td",[e._v(" "+e._s(t.date)+" ")]),e.isDoctor?n("td",{staticClass:"cursor-hover",on:{click:function(n){return e.deleteAppointment(t._id)}}},[e._v(" X ")]):e._e()])})),0)]),e.appointments.length?e._e():n("b-alert",{attrs:{show:""}},[e._v(" Запланированные посещения врача отсутствуют ")])],1)},M=[],$=(n("c740"),n("a434"),function(e){Object(h["a"])(n,e);var t=Object(v["a"])(n);function n(e){var r;return Object(c["a"])(this,n),r=t.call(this),r.id=e,r.getAllAppointments=r.getAllAppointments.bind(Object(f["a"])(r)),r.getAppointmentById=r.getAppointmentById.bind(Object(f["a"])(r)),r.createAppointment=r.createAppointment.bind(Object(f["a"])(r)),r.updateAppointment=r.updateAppointment.bind(Object(f["a"])(r)),r.deleteAppointment=r.deleteAppointment.bind(Object(f["a"])(r)),r.searchAppointments=r.searchAppointments.bind(Object(f["a"])(r)),r.modelRequest=r.getModelRequest(),r.modelBaseUrl=r._buildUrl(),r}return Object(u["a"])(n,[{key:"getModelRequest",value:function(){var e="/appointments";return this.id&&(e="/appointments/".concat(this.id)),e}},{key:"getAllAppointments",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.get();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getAppointmentById",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.get();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"searchAppointments",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.modelBaseUrl,this.modelBaseUrl+="/search",e.next=4,this.get(t);case 4:return r=e.sent,this.modelBaseUrl=n,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createAppointment",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,n,r,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.post({client:t,doctor:n,time:r,date:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t,n,r,a){return e.apply(this,arguments)}return t}()},{key:"updateAppointment",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,n,r,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.id){e.next=2;break}throw new Error("No id for appointment specified");case 2:return e.next=4,this.post({client:t,doctor:n,time:r,date:a});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));function t(t,n,r,a){return e.apply(this,arguments)}return t}()},{key:"deleteAppointment",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.id){e.next=2;break}throw new Error("No id for appointment specified");case 2:return e.next=4,this.delete();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(p)),H={name:"OwnAppointments",props:{refreshTrigger:Boolean,isDoctor:Boolean},data:function(){return{appointments:[]}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadOwnAppointments();case 2:case"end":return t.stop()}}),t)})))()},watch:{refreshTrigger:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.loadOwnAppointments();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},methods:{loadOwnAppointments:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new $,r={fromDate:new Date(Date.now()).toISOString()},e.isDoctor?r.doctor=b.currentUserId:r.client=b.currentUserId,t.prev=3,t.next=6,n.searchAppointments(r);case 6:a=t.sent,e.appointments=a.appointments,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](3),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})))()},deleteAppointment:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=new $(e),a=t.appointments.findIndex((function(t){return t._id=e})),t.appointments.splice(a,1),console.log(t.appointments),n.prev=4,n.next=7,r.deleteAppointment();case 7:return s=n.sent,console.log(s),n.next=11,t.loadOwnAppointments();case 11:n.next=16;break;case 13:n.prev=13,n.t0=n["catch"](4),console.log(n.t0);case 16:case"end":return n.stop()}}),n,null,[[4,13]])})))()}}},W=H,N=(n("bbd6"),Object(y["a"])(W,q,M,!1,null,"4a6fbb80",null)),F=N.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.times.length?n("table",{staticClass:"table table-striped table-hover"},[n("thead",{staticClass:"thead-dark"},[n("tr",e._l(Object.keys(e.doctorProfile.dayTimes),(function(t){return n("th",{key:t.toString(),attrs:{scope:"col"}},[e._v(" "+e._s(t.toUpperCase())+" ")])})),0)]),n("tbody",e._l(Object.keys(e.doctorProfile.dayTimes),(function(t){return n("td",{key:t},[n("table",{staticClass:"table table-hover"},[n("tbody",[e._l(e.dayTimes[t],(function(r,a){return n("tr",{key:r,staticClass:"w-100 table-row-pointer",attrs:{scope:"row"}},[n("td",[e._v(e._s(e.formattedTimes[r].hours)+":"+e._s(e.formattedTimes[r].minutes))]),n("td",{staticClass:"cursor-pointer",on:{click:function(n){return e.deleteDayTime(t,a)}}},[e._v(" X ")])])})),n("tr",{staticClass:"w-100"},[n("b-form-select",{staticClass:"mt-3",attrs:{options:e.timesOptions[t]},model:{value:e.selectedTimes[t],callback:function(n){e.$set(e.selectedTimes,t,n)},expression:"selectedTimes[day]"}}),n("b-button",{staticClass:"mt-1",attrs:{variant:"success"},on:{click:function(n){return e.addDayTime(t)}}},[e._v(" + Time ")])],1)],2)])])})),0)]):e._e()])},J=[],G=(n("4de4"),n("7db0"),n("d81d"),n("ac1f"),n("1276"),function(e){Object(h["a"])(n,e);var t=Object(v["a"])(n);function n(e){var r;return Object(c["a"])(this,n),r=t.call(this),r.id=e,r.getllTimes=r.getAllTimes.bind(Object(f["a"])(r)),r.modelRequest=r.getModelRequest(),r.modelBaseUrl=r._buildUrl(),r}return Object(u["a"])(n,[{key:"getModelRequest",value:function(){var e="/times";return this.id&&(e="/times/".concat(this.id)),e}},{key:"getAllTimes",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.get();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(p)),X=function(e){Object(h["a"])(n,e);var t=Object(v["a"])(n);function n(e){var r;return Object(c["a"])(this,n),r=t.call(this),r.id=e,r.updateDoctorProfile=r.updateDoctorProfile.bind(Object(f["a"])(r)),r.modelRequest=r.getModelRequest(),r.modelBaseUrl=r._buildUrl(),r}return Object(u["a"])(n,[{key:"getModelRequest",value:function(){var e="/doctors";return this.id&&(e="/doctors/".concat(this.id)),e}},{key:"updateDoctorProfile",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.put(t);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),n}(p),z={name:"DoctorSchedule",props:{doctorId:String,doctorProfile:Object},data:function(){return{dayTimes:{monday:[],tuesday:[],wednesday:[],thursday:[],friday:[]},times:[],selectedTimes:{monday:null,tuesday:null,wednesday:null,thursday:null,friday:null}}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=new G,t.next=4,n.getAllTimes();case 4:r=t.sent,e.times=r.times,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},mounted:function(){var e=Object.assign({},this.doctorProfile.dayTimes);this.dayTimes=e},computed:{formattedTimes:function(){var e={};return this.times.forEach((function(t){var n={hours:t.time.split(":")[0],minutes:t.time.split(":")[1]};e[t._id]=n})),e},timesOptions:function(){var e=this,t={};return Object.keys(this.dayTimes).forEach((function(n){var r=e.times.filter((function(t){var r=e.dayTimes[n].find((function(e){return t._id===e}));return!r})),a=r.map((function(e){return{text:e.time,value:e._id}}));t[n]=a})),t}},methods:{deleteDayTime:function(e,t){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,n.dayTimes[e].splice(t,1),a=new X(n.doctorId),r.next=5,a.updateDoctorProfile({dayTimes:n.dayTimes});case 5:s=r.sent,console.log(s),r.next=12;break;case 9:r.prev=9,r.t0=r["catch"](0),console.log(r.t0);case 12:case"end":return r.stop()}}),r,null,[[0,9]])})))()},addDayTime:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.dayTimes[e].push(t.selectedTimes[e]),r=new X(t.doctorId),n.next=5,r.updateDoctorProfile({dayTimes:t.dayTimes});case 5:a=n.sent,console.log(a),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](0),console.log(n.t0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])})))()}}},K=z,Q=Object(y["a"])(K,L,J,!1,null,null,null),V=Q.exports,Y=function(){var e=this,t=this,n=t.$createElement,r=t._self._c||n;return r("div",{staticClass:"container-fluid"},[r("div",{staticClass:"row"},[r("b-button",{staticClass:"col-2",on:{click:t.loadNextWeekDatesAndAppointments}},[t._v(" Следующая неделя ")]),r("b-form-select",{staticClass:"col-2 ml-5",attrs:{options:t.doctorsOptions},on:{change:t.refreshData},model:{value:t.selectedDoctor,callback:function(e){t.selectedDoctor=e},expression:"selectedDoctor"}}),r("div",{staticClass:"col-3 d-flex ml-2"},[r("b-input",{attrs:{id:"selectedDateInput",disabled:""},model:{value:t.selectedDateText,callback:function(e){t.selectedDateText=e},expression:"selectedDateText"}})],1),r("b-button",{attrs:{variant:"primary"},on:{click:t.submitAppointment}},[t._v(" + Записаться на приём ")])],1),t.times.length?r("AppointmentsTable",{staticClass:"mt-2 row",attrs:{fromDate:t.fromDate,toDate:t.toDate,times:t.times,appointments:t.appointments,doctorProfile:t.selectedDoctorProfile},on:{"select-date":function(t){e.selectedDate=t}}}):t._e()],1)},Z=[],ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("table",{staticClass:"table table-striped table-hover"},[n("thead",{staticClass:"thead-dark"},[n("tr",e._l(Object.keys(e.tableHeaderDays),(function(t){return n("th",{key:t.toString(),attrs:{scope:"col"}},[e._v(" "+e._s(t.toUpperCase())+" "+e._s(e.tableHeaderDays[t])+" ")])})),0)]),n("tbody",e._l(Object.keys(e.filteredDayTimes),(function(t){return n("td",{key:t},[n("table",{staticClass:"table table-hover"},[n("tbody",e._l(e.filteredDayTimes[t],(function(t){return n("tr",{key:t.toISOString(),staticClass:"w-100 table-row-pointer",attrs:{scope:"row"},on:{click:function(n){return e.$emit("select-date",t)}}},[e._v(" "+e._s(t.getUTCHours())+":"+e._s(t.getUTCMinutes())+"0 ")])})),0)])])})),0)])])},te=[],ne=(n("4fad"),n("3835")),re=["monday","tuesday","wednesday","thursday","friday"],ae={name:"AppointmentsTable",props:{times:Array,appointments:Array,fromDate:Date,toDate:Date,doctorProfile:Object},data:function(){return{dayTimes:{monday:[],tuesday:[],wednesday:[],thursday:[],friday:[]}}},mounted:function(){this.formatDayTimes()},watch:{doctorProfile:function(){this.formatDayTimes()},fromDate:function(){this.formatDayTimes()},toDate:function(){this.formatDayTimes()}},computed:{filteredDayTimes:function(){var e=this,t=Object.assign({},this.dayTimes);console.log(t);for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];t[a]=t[a].filter((function(t){return!e.appointments.find((function(e){var n=new Date(e.date),r=new Date(t.toISOString()),a=n.getTime()===r.getTime();return a}))}))}return t},tableHeaderDays:function(){var e={};if(this.dayTimes.monday.length>0)for(var t=0,n=Object.entries(this.dayTimes);t<n.length;t++){var r=Object(ne["a"])(n[t],2),a=r[0],s=r[1],o=new Date(s[0].toISOString());e[a]="".concat(o.getDate(),"/").concat(o.getMonth()+1)}return e}},methods:{formatDayTimes:function(){var e=this,t=function(e){var t=new Date;return t.setDate(e.getDate()+1),t.setUTCHours(0,0,0,0),t},n={};n[re[0]]=this.fromDate;for(var r=1;r<re.length;r++)n[re[r]]=t(n[re[r-1]]);for(var a={},s=function(){var t=Object(ne["a"])(i[o],2),n=t[0],r=t[1],s=e.times;e.doctorProfile&&(s=e.times.filter((function(t){return e.doctorProfile.dayTimes[n].find((function(e){return t._id===e}))}))),a[n]=s.map((function(e){var t=e.time.split(":"),n=Object(ne["a"])(t,2),a=n[0],s=n[1];a=parseInt(a,10),s=parseInt(s,10);var o=new Date(r);return o.setUTCHours(a,s,0,0),o}))},o=0,i=Object.entries(n);o<i.length;o++)s();console.log(a),this.dayTimes=a}}},se=ae,oe=(n("7074"),Object(y["a"])(se,ee,te,!1,null,"5640553c",null)),ie=oe.exports,ce={name:"CalendarAppointments",components:{AppointmentsTable:ie},data:function(){return{times:[],doctors:[],appointments:[],doctorsOptions:[],fromDate:null,toDate:null,selectedDoctor:null,selectedDate:null,weekDate:new Date}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.setFromToDates(e.weekDate),t.next=3,e.loadTimes();case 3:return t.next=5,e.loadDoctors();case 5:return t.next=7,e.loadAppointments();case 7:case"end":return t.stop()}}),t)})))()},computed:{selectedDateText:function(){return this.selectedDate?this.selectedDate.toISOString():"Дата посещения не выбрана..."},selectedDoctorProfile:function(){var e=this,t=this.doctors.find((function(t){return t._id===e.selectedDoctor}));return t.doctor}},methods:{loadNextWeekDatesAndAppointments:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new Date,n.setDate(e.weekDate.getDate()+7),n.setUTCHours(0,0,0,0),e.weekDate=n,e.setFromToDates(n),t.next=7,e.loadAppointments();case 7:case"end":return t.stop()}}),t)})))()},setFromToDates:function(e){var t=e.getDay(),n=e.getDate()-t+(0===t?-6:1),r=new Date(e.setDate(n));r.setUTCHours(0,0,0,0),this.fromDate=r;var a=new Date;a.setDate(r.getDate()+4),a.setUTCHours(0,0,0,0),this.toDate=a},loadTimes:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new G,t.prev=1,t.next=4,n.getllTimes();case 4:r=t.sent,e.times=r.times,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},loadDoctors:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new b,t.prev=1,t.next=4,n.getAllDoctors();case 4:r=t.sent,e.doctors=r.doctors,e.doctorsOptions=r.doctors.map((function(e){return{text:e.name,value:e._id}})),e.selectedDoctor=r.doctors[0]._id||null,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})))()},loadAppointments:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new $,r={},e.fromDate&&(r.fromDate=e.fromDate.toISOString()),e.toDate&&(r.toDate=e.toDate.toISOString()),e.selectedDoctor&&(r.doctor=e.selectedDoctor),t.prev=5,t.next=8,n.searchAppointments(r);case 8:a=t.sent,e.appointments=a.appointments,t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[5,12]])})))()},submitAppointment:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.times.find((function(t){var n=e.selectedDate.toISOString().split("T")[1],r=n.split(":")[0]+":"+n.split(":")[1];return t.time===r})),t.prev=1,r=new $,t.next=5,r.createAppointment(b.currentUserId,e.selectedDoctor,n._id,e.selectedDate.toISOString());case 5:return a=t.sent,console.log(a),t.next=9,e.refreshData();case 9:e.$emit("refresh-own-appointments"),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[1,12]])})))()},refreshData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("im here"),e.setFromToDates(e.weekDate),t.next=4,e.loadAppointments();case 4:case"end":return t.stop()}}),t)})))()}}},ue=ce,le=Object(y["a"])(ue,Y,Z,!1,null,null,null),pe=le.exports,de={name:"AppointmentsPage",components:{Profile:B,OwnAppointments:F,CalendarAppointments:pe,DoctorSchedule:V},data:function(){return{user:null,refreshTrigger:!1}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadUserInfo();case 2:case"end":return t.stop()}}),t)})))()},methods:{loadUserInfo:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=new b(b.currentUserId),t.next=4,n.getUserById();case 4:r=t.sent,e.user=r.user,r.doctor&&(e.user.doctor=r.doctor),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},refreshOwnAppointments:function(){this.refreshTrigger=!this.refreshTrigger}}},me=de,fe=Object(y["a"])(me,U,A,!1,null,"bfdc1d72",null),he=fe.exports,ve=[{path:"/",redirect:function(){return p.currentUserId?{name:"appointments"}:{name:"login"}}},{path:"/appointments",component:he,name:"appointments",meta:{public:!0}},{path:"/login",component:x,name:"login"},{path:"/signup",component:R,name:"signup"}],be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-navbar",{attrs:{type:"dark",variant:"info"}},[n("b-navbar-brand",{attrs:{href:"#"}},[e._v("Харьковская городская поликлиника №3")]),n("b-navbar-nav",{staticClass:"ml-3"},[n("b-nav-item",{attrs:{href:"/appointments"}},[e._v("Записи посещений")])],1),n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-item",{staticClass:"ml-auto",attrs:{href:"/signup"}},[e._v("Регистрация")]),n("b-nav-item",{on:{click:e.logout}},[e._v("Выход из аккаунта")])],1)],1)},ge=[],we={name:"Header",methods:{logout:function(){p.clearAuthToken(),this.$router.history.push("/")}}},ye=we,ke=Object(y["a"])(ye,be,ge,!1,null,"224d05dc",null),xe=ke.exports,Oe=new o["a"]({routes:ve,mode:"history"}),_e={name:"App",components:{Header:xe},router:Oe},De=_e,je=(n("034f"),Object(y["a"])(De,a,s,!1,null,null,null)),Te=je.exports,Re=n("5f5b");n("acc7");r["default"].use(Re["a"]),r["default"].use(o["a"]),r["default"].config.productionTip=!1,new r["default"]({render:function(e){return e(Te)}}).$mount("#app")},7074:function(e,t,n){"use strict";var r=n("cedd"),a=n.n(r);a.a},"85ec":function(e,t,n){},acc7:function(e,t,n){},bbd6:function(e,t,n){"use strict";var r=n("3e03"),a=n.n(r);a.a},cedd:function(e,t,n){}});
//# sourceMappingURL=app.51df38a5.js.map